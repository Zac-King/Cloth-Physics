<!doctype html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Unity WebGL Player | Cloth Physics</title>
    <link rel="stylesheet" href="TemplateData/style.css">
    <link rel="shortcut icon" href="TemplateData/favicon.ico" />
    <script src="TemplateData/UnityProgress.js"></script>
  </head>
  
  
  <body class="template">

	
    <p class="footer">&laquo; created with <a href="http://unity3d.com/" title="Go to unity3d.com">Unity</a> &raquo;</p>
	<div>
	<h3>Cloth Physics</h3>
	</div>
	
	<p class="header"><span>Unity WebGL Player | </span>Cloth Physics</p>
    <div class="template-wrap clear">
    <canvas class="emscripten" id="canvas" oncontextmenu="event.preventDefault()" height="600px" width="960px"></canvas>
      <div class="logo"></div>
      <div class="fullscreen"><img src="TemplateData/fullscreen.png" width="38" height="38" alt="Fullscreen" title="Fullscreen" onclick="SetFullscreen(1);" /></div>
      <div class="title">Cloth Physics</div>
	  
	  	<div style="color:#0000FF">
	<h3> Instructions </h3>
	<p>
	Left click to move the nodes<br>
	Right click while Left click is down to lock or unlock node<br>
	Reset cloth Button to make a new cloth based on the width and height slider<br>
	Wind sliders to change the direction and intensity of the wind<br>
	Spring slider to affect how tight or loose the spings are<br>
	Dampen slider to affect how much the springs react to movements<br>
	</p>
	</div>
	
	<div>
	<h3>Documentation</h3>
	<p>
	I.0: Requirements Documentation<br>
<br>
I.1: Description of the problem<br>
Name: Cloth physics simulation<br>
Problem Statement: Implement a system that simulates cloth like behavior when forces are applied to it by use of springs.<br>
<br>
I.2: Input Information<br>
Name: Gravity Mod - Slider<br>
Description: Slider bar located in the lower left corner of the user display, makes use of the SetGravityMod() function located in the ClothPhysicsTest.cs. Allowing the user to edit the Gravity at runtime.<br>
<br>
Name: Spring<br>
Description: Slider bar that changes the springCon of all the springs in clothSprings<br>
<br>
Name: Dampen<br>
Description: Slider bar that changes the springDamp of all the springs in clothSprings<br>
<br>
Name: Width<br>
Description: Slider, Controls the desired cloth width <br>
<br>
Name: Height<br>
Description: Slider, Controls the desired cloth height<br>
<br>
Name: Reset Cloth<br>
Description: Button that destroys the old cloth and spawns a new one<br>
<br>
I.3: Output Information<br>
Visual display of a cloth like behavior applied to a grid of particles.<br>
<br>
I.4: User Interface Information<br>
Sliders<br>
Use to change values at run time<br>
<br>
Mouse controls<br>
Left click and drag to move the clicked node. While left clicking right click to lock or unlock node.<br>
<br>
II.0: Design Documentation<br>
<br>
II.1 System Architecture Description<br>
The application makes use of 3 scripts controlling the force calculations. ClothNode.cs contains the particle information, as well as the UpdateClothNode() Function to apply the changes to information. The Spring.cs contains all the sping information as well as the 2 particles the spring is attached to. Both of which are called in the ClothPhysicsTest.cs which manages all the clothNodes, as well as all the clothSprings.<br> 
<br>
II.2: Information about the functions<br>
<br>
File: ClothNode.cs<br>
Class: ClothNode<br>
<br>
Data Members:<br>
<br>
Name: locked<br>
Type: bool	- public<br>
Description: Value to determine whether or not node will act as a cloth Anchor, and be unmoved by other forces.<br>
<br>
Name: mass<br>
Type: float	- public<br>
Description:  Particle mass, in use in Force calculations (Force = mass * acceleration)<br>
<br>
Name: acceleration<br>
Type: Vector3	- public<br>
Description: <br>
<br>
Name: velocity<br>
Type: Vector3	- public<br>
Description: Applied to the node position <br>
<br>
Name: force<br>
Type: Vector3	- public<br>
Description: sum of combined forces <br>
<br>
Name: gravity<br>
Type: Vector3	- public<br>
Description: downward force to be applied to the force variable. Used to simulate real world gravitation force. ( 0, -9. 0 )<br>
<br>
Function: UpdateClothNode<br>
Parameters: float _gravMod<br>
Description: Apply motion to nodeâ€™s position if !locked<br>
Return: void<br>
<br>
Function: ToggleLock<br>
Parameters: self<br>
Description: Invert the locked boolean based on current value<br>
Return: void<br>
<br>
File: Spring.cs<br>
<br>
Name: P1<br>
Type: GameObject 	- public<br>
Description: stored reference to node connected node, spring is the connection between P1 and P2<br>
<br>
Name: P2<br>
Type: GameObject	- public<br>
Description: stored reference to node connected node, spring is the connection between P1 and P2<br>
<br>
Name: springConstant<br>
Type: float	- public<br>
Description: How stiff the spring pulls and pushes away/towards<br>
<br>
Name: breakLength<br>
Type: float	- public<br>
Description: Distance in which the spring destroys itself<br>
<br>
Name: restLength<br>
Type: float	- public<br>
Description: Distance between the P1 and P2 nodes the spring is trying to reach<br>
<br>
Name: damperConstant<br>
Type: float 	- public<br>
Description: how much each node react to other neighboring nodes<br>
<br>
Function: MakeSpring<br>
Parameters: GameObject _p1, GameObject _p2, float _sCon, float _dCon<br>
Description: Assigns the initial values of a spring<br>
Return: void<br>
<br>
Function: DrawSpring<br>
Parameters: self<br>
Description: draw a line between P1 and P2<br>
Return: void<br>
<br>
Function: ComputeSpringForces<br>
Parameters: self<br>
Description: calculates spring forces<br>
Return: void<br>
<br>
Function: UpdateSpring<br>
Parameters: self<br>
Description: calls both ComputSpringForce() and DrawSpring() for ease of use when updating<br>
Return: void<br>
<br>
File: ClothPhysicsTest.cs<br>
<br>
Name: clothWidth<br>
Type: int 	- private - serialized <br>
Description: for node spawn width. How many nodes wide<br>
<br>
Name: clothHeight<br>
Type: int 	- private - serialized <br>
Description: for node spawn width. How many nodes height<br>
<br>
Name: initSpacing<br>
Type: float 	- private - serialized <br>
Description: for node spawn spacing.<br>
<br>
Name: clothNodePrefab<br>
Type: GameObject	- private - serialized <br>
Description: reference to node prefab<br>
<br>
Name: gravityMod<br>
Type: float	- private - serialized<br>
Description: Modify gravitational force at runtime. passed into UpdateClothNode(GravityMod)<br>
<br>
Name: clothNodes<br>
Type: List<GameObjects>	- public<br>
Description: Stored reference to all the clothNodes<br>
<br>
Name: clothSprings<br>
Type: List<GameObjects>	- public<br>
Description: Stored reference to all the clothSprings<br>
<br>
Function: SpawnNodes<br>
Parameters: self<br>
Description: Instantiates the nodes based on member variables<br>
Return: void<br>
<br>
Function: SpawnSprings<br>
Parameters: self<br>
Description:  Instantiates the springs based on existing nodes in clothNodes<br>
Return: void<br>
<br>
Function: FixedUpdate<br>
Parameters: self<br>
Description: Updates each node and sping in clothNodes and clothSprings<br>
Return: void<br>
<br>
Function: SetGravityMod<br>
Parameters: float g<br>
Description: assigns gravityMod to the value of g. For use of Gravity Mod Slider<br>
Return: void<br>
<br>
File: ClothAeroTriangle.cs<br>
<br>
Name: nodeA<br>
Type: GameObject	- public<br>
Description: Reference to a one corner triangle<br>
<br>
Name: nodeB<br>
Type: GameObject	- public<br>
Description: Reference to a one corner triangle<br>
<br>
Name: nodeC<br>
Type: GameObject	- public<br>
Description: Reference to a one corner triangle<br>
<br>
Function: ComputeTriangleForces<br>
Parameters: Vector3 air_Velocity, float density, float drag<br>
Description: <br>
Return: void<br>
<br>
<br>
III.0: Implementation Documentation<br>
<br>
	</p>
	</div>
	
    </div>
	

	
	
	
    <script type='text/javascript'>
  // connect to canvas
  var Module = {
    TOTAL_MEMORY: 268435456,
    filePackagePrefixURL: "Release/",
    memoryInitializerPrefixURL: "Release/",
    preRun: [],
    postRun: [],
    print: (function() {
      return function(text) {
        console.log (text);
      };
    })(),
    printErr: function(text) {
      console.error (text);
    },
    canvas: document.getElementById('canvas'),
    progress: null,
    setStatus: function(text) {
      if (this.progress == null) 
      {
        if (typeof UnityProgress != 'function')
          return;
        this.progress = new UnityProgress (canvas);
      }
      if (!Module.setStatus.last) Module.setStatus.last = { time: Date.now(), text: '' };
      if (text === Module.setStatus.text) return;
      this.progress.SetMessage (text);
      var m = text.match(/([^(]+)\((\d+(\.\d+)?)\/(\d+)\)/);
      if (m)
        this.progress.SetProgress (parseInt(m[2])/parseInt(m[4]));
      if (text === "") 
        this.progress.Clear()
    },
    totalDependencies: 0,
    monitorRunDependencies: function(left) {
      this.totalDependencies = Math.max(this.totalDependencies, left);
      Module.setStatus(left ? 'Preparing... (' + (this.totalDependencies-left) + '/' + this.totalDependencies + ')' : 'All downloads complete.');
    }
  };
  Module.setStatus('Downloading (0.0/1)');
</script>
<script src="Release/UnityConfig.js"></script>
<script src="Release/fileloader.js"></script>
<script>if (!(!Math.fround)) {
  var script = document.createElement('script');
  script.src = "Release/Builds.js";
  document.body.appendChild(script);
} else {
  var codeXHR = new XMLHttpRequest();
  codeXHR.open('GET', 'Release/Builds.js', true);
  codeXHR.onload = function() {
    var code = codeXHR.responseText;
    if (!Math.fround) { 
try {
  console.log('optimizing out Math.fround calls');
  var m = /var ([^=]+)=global\.Math\.fround;/.exec(code);
  var minified = m[1];
  if (!minified) throw 'fail';
  var startAsm = code.indexOf('// EMSCRIPTEN_START_FUNCS');
  var endAsm = code.indexOf('// EMSCRIPTEN_END_FUNCS');
  var asm = code.substring(startAsm, endAsm);
  do {
    var moar = false; // we need to re-do, as x(x( will not be fixed
    asm = asm.replace(new RegExp('[^a-zA-Z0-9\\$\\_]' + minified + '\\(', 'g'), function(s) { moar = true; return s[0] + '(' });
  } while (moar);
  code = code.substring(0, startAsm) + asm + code.substring(endAsm);
  code = code.replace("'use asm'", "'almost asm'");
} catch(e) { console.log('failed to optimize out Math.fround calls ' + e) }
 }

    var blob = new Blob([code], { type: 'text/javascript' });
    codeXHR = null;
    var src = URL.createObjectURL(blob);
    var script = document.createElement('script');
    script.src = URL.createObjectURL(blob);
    script.onload = function() {
      URL.revokeObjectURL(script.src);
    };
    document.body.appendChild(script);
  };
  codeXHR.send(null);
}
</script>
  </body>
</html>
